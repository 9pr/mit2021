<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>География и геометрия</title>

		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/sky.css" id="theme">
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin="" />
		
		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css" id="highlight-theme">

		<style>
			input, select {
				font-size: 25px;
			}
			#table {
				font-size: 70%;
			}
			.hide {
				display: none;
			}
			.map {
				height: 350px;
			}
		</style>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">

				<section class="center" data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						География и геометрия
						=========================
				
						Note:
						Заголовок
					</script>
				</section>

				<section class="center" data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						Определения
						-----------

					</script>
				</section>

				<section data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						### География

						География (от др.греч Γεωγραφια землеописание) - комплекс естественных 
						и общественных наук, изучающих структуру, функционирование и 
						эволюцию географической оболочки, взаимодействие и распределение
						в пространстве природных и природно-общественных геосистем и их
						компонентов.
				
						Note:
						
					</script>
				</section>

				<section data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						### География

						География изучает поверхность Земли, её природные
						условия, распределение на ней природных объектов, населения,
						экономических ресурсов.
				
						Note:

					</script>
				</section>

				<section data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						### Геометрия

						Геометрия (от др.греч. 
						&Gamma;&epsilon;&omega;&mu;&epsilon;&tau;&rho;&iota;&alpha;
						землемерие) - 
						раздел математики, изучающий пространственные
						структуры и отношенияя, а так же их обобщения.

						Note:

					</script>
				</section>

				<section class="center" data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						Координаты
						-----------

					</script>
				</section>

				<section data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						### Географические координаты

						Географические координаты - обобщение понятие о
						геодезических и астрономических координатых, когда 
						Земля принимается за шар, а не элипсоид вращения.
						Географические координаты определяют положение точки на
						земной поверхности или, более широко, в географической
						оболочке. 

						Note:

					</script>
				</section>

				<section data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						### Географические координаты

						Географические координаты строятся по принципу
						сферических. Аналогичные координаты применяются
						и для других планет, а так же на небесной сфере.

						Note:

					</script>
				</section>

				<section data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						### Широта

						Широта - угол $\phi$ между местным направлением зенита
						и плоскостью экватора, отчитываемый от $0^\circ$ до $90^\circ$
						в обе стороны от экватора. Географическую широту точек
						лежащих в северном полушарии, принято считать положительной,
						широту в южном полушарии отрицательной. 
						

						Note:

					</script>
				</section>

				<section data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						### Широта

						Из-за отличия формы Земли от шара, географическая
						широта точек несколько отличается от их геоцентрической
						широты, то есть угла между направлением на данную точку
						из центра Земли и плоскостью экватора.
						
						Note:

					</script>
				</section>

				<section data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						### Широта

						Широту места можно определить с помощью таких
						астрономических инструментов, как секстант или 
						гномон. Также можно воспользоваться системами
						GPS, ГЛОНАСС и др.
						
						Note:

					</script>
				</section>

				<section data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						### Долгота

						Долгота - это двугранный угол $\lambda$ между 
						плоскостью меридиана, проходящего через данную точку,
						и плоскостью начального нулевого меридиана, от которого
						ведется отсчет долготы. Долготу от $0^\circ$ до $180^\circ$ к
						востоку от нулевого меридиана называют восточной, к западу -
						западной. Восточные долготы принято считать положительными,
						западные - отрицательными.
						
						Note:

					</script>
				</section>

				<section data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						### Долгота

						Выбор нулевого меридиана произволен и зависит
						только от соглашений. Сейчас за нулевой меридиан принят
						меридиан, проходящий рядом с обсерваторией в Гринвиче. 
						От долготы так же зависит местное солнечное время.
						
						Note:

					</script>
				</section>

				<section data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						### Формы записи географических координат

						Координаты (широта от $-90^\circ$ до $90^\circ$,
						долгота от $-180^\circ$ до $180^\circ$) могут
						записываться:

						
						Note:

					</script>
				</section>

				<section data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						### Формы записи географических координат

						- в градусах в виде десятичной дроби (
							современный вариант)
						- в градусах и минутах с десятичной дробью
						- в градусах, минутах и секундах с десятичной
							дробью (историческая форма записи)
						- предыдущие варианты с дополнительными буквами 
							(E, W, S, N)
						
						Note:

					</script>
				</section>

				<section data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						### Формы записи географических координат

						Форматы можно пересчитать по формуле:
						$1^\circ$ = $60'$, $1'$ = $60''$.
						
						Примеры:  
						$55,755831^\circ$  $37,617613^\circ$  
						$N55,755831^\circ$  $E37,617613^\circ$  
						$55^\circ45.35'$  $37^\circ37.06'$    
						$55^\circ45'20.9916''N$  $37^\circ37'3.6228''E$    

						Note:

					</script>
				</section>

				<section class="center" data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						Величины
						-----------

					</script>
				</section>

				<section data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						### Радиан

						Радиан (от лат. radius луч) - угол соответствующий дуге,
						длина которой равна её радиусу. Единица измерения
						плоских углов в международной системе единиц (СИ)
						
						Note:

					</script>
				</section>

				<section data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						### Градус

						Градус (от лат. шаг, ступень) - обозначается. 
						Один полный оборот соответствует углу в $360^\circ$.
						В прямом угле $90^\circ$. В развернутом $180^\circ$.
						
						Note:

					</script>
				</section>

				<section data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						### Перевод величин

						$$
							\alpha^\circ = \alpha_\text{рад}\tfrac{180^\circ}{\pi}
						$$

						$$
							\alpha_\text{рад} = \tfrac{\pi}{180^\circ} \alpha_\text{рад}
						$$
						Note:

					</script>
				</section>

				<section>
					<h3>Конвертер величин</h3>
					<input type="text" name="" id="converter_value" 
						placeholder="Градусы или радианы">
					<select id="converter_type">
						<option value="radian">Радиан</option>
						<option value="degree">Градус</option>
					</select>
					<input type="button" id="converter_button" value="Конвертировать">
					<output id="converter_out"></output>
				</section>

				<section class="center" data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						Тригонометрия
						-----------

					</script>
				</section>

				<section data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						### Тригонометрические функции

						Тригонометрические функции - элементарные функции,
						которые исторически возникли при рассмотрении
						прямоугольных треугольников и выражали зависимости длин
						сторон этих треугольников от прямых углов при гипотенузе.
						
						Note:

					</script>
				</section>

				<section>
					<h3>Тригонометрический круг</h3>
					<div id="plot" style="height: 400px; margin-left:25%;"></div>
				</section>

				<section data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						### Тригонометрические функции

						$$
						\sin \alpha = \tfrac{y_b}{R}
						$$
						$$
						\cos \alpha = \tfrac{x_b}{R}
						$$
						$$
						\tg \alpha = 
							\tfrac{\sin \alpha}{\cos \alpha} =
							\tfrac{y_b}{x_b}
						$$
						$$
						\ctg \alpha = 
							\tfrac{\cos \alpha}{\sin \alpha} =
							\tfrac{x_b}{y_b}
						$$
						
						Note:

					</script>
				</section>

				<section>
					<h3>Таблица тригонометрических функций</h3>
					<output id="table"></output>
				</section>

				<section data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						### Ортодромия
		
						Ортодромия (от греч. 
						$O\rho\theta\omicron\delta\rho\omicron\mu\omicron\varsigma$
						 прямой путь) в геометрии -
						кратчайшая линия между двумя точками на поверхности вращения.
						
						В картографии и навигации ортодромия - кратчайшее расстояние
						между двумя точками на поверхности Земли. 

						Частыми случаями ортодромии являются меридианы и экватор.
						
						Note:

					</script>
				</section>

				<section data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						### Рассчет ортодромии

						Длина ортодромии равна $D = l \cdot \delta $, где
						$
							\delta = \arccos(
								\sin \phi_1 \cdot \sin \phi_2 +
								\cos \phi_1 \cdot \cos \phi_2 \cdot
								\cos(\lambda_2 - \lambda_1)
							)
						$

						$\phi_1$ = широта начальной точки в градусах  
						$\phi_2$ = широта конечной точки в градусах  
						$\lambda_1$ = долгота начальной точки в градусах  
						$\lambda_2$ = долгота конечной точки в градусах  
						$l$ = длина дуги меридиана небесного тела
						Note:

					</script>
				</section>

				<section>
					<h3>Рассчет ортодромии</h3>
					<div>
						<label>Широта А
							<input type="text" id="latA">
						</label> <br>
						<label>Долгота А
							<input type="text" id="lonA">
						</label>
					</div>
					<div>
						<label>Широта B
							<input type="text" id="latB">
						</label> <br>
						<label>Долгота B
							<input type="text" id="lonB">
						</label>
					</div>
					<div>
						<input id="ortodroma" type="button" value="Посчитать">
					</div>
					<output id="ortodroma_out"></output>
				</section>

				<section class="center" data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						Игры
						----

						
						Note:

					</script>
				</section>

				<section>
					<h3>Игра 1. Города классические</h3>
					<div id="game1_button_start" class="show">
						<input type="button" value="Начать игру" id="game1_start">
					</div>
					<div id="game1_area" class="hide">
						<label for="game1_town">Ваш город:</label>
						<input type="text" id="game1_town" >
						<input type="button" id="game1_set_result" value="Отправить город">
						<output id="game1_town2"></output>
					</div>
					<div class="map" id="game1_map"></div>
				</section>

				<section>
					<h3>Игра 2. Города на расстояние</h3>
					<div id="game2_button_start" class="show">
						<input type="button" value="Начать игру" id="game2_start">
					</div>
					<div id="game2_area" class="hide">
						<label for="game2_town">Ваш город:</label>
						<input type="text" id="game2_town" >
						<input type="button" id="game2_set_result" value="Отправить город">
						<output id="game2_town2"></output>
					</div>
					<div id="game2_score" class="hide">
						<span>Счет: </span>
						<span id="game2_score"></span>
					</div>
					<div class="map" id="game2_map"></div>
				</section>

				<section>
					<h3>Игра 3. Города на расстояние. Многопользовательская</h3>
					<label for="game3_name"></label>
					<input type="text" id="game3_name">
					<input type="button" value="Начать игру" id="game3_start">
					<label for="game3_town">Ваш город:</label>
					<input type="text" id="game3_town" >
					<input type="button" id="game3_set_result" value="Отправить город">
					<output id="game3_town2"></output>
					<div>
						<span>Счет: </span>
						<span id="game3_score"></span>
					</div>
				</section>

				<section class="center" data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						Веселые картинки
						----

						Note:

					</script>
				</section>

				<section
					data-background-image="image/1.jpg"
					data-menu-title="Абстрактная живопись"
				></section>

				<section
					data-background-image="image/yoda.jpg"
					data-background-size="contain"
					data-menu-title="Мастер Йода"
				></section>

				<section data-menu-title="Конь Юлий">
					<img src="image/juliy.jpg" alt="Конь Юлий">
				</section>		
				
				

				<section class="center" data-markdown  data-separator-notes="^Note:">
					<script type="text/template">
						Спасибо за внимание
					</script>
				</section>



			</div>
		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script src="plugin/math/math.js"></script>

		<script src="js/algebrite.bundle-for-browser.js"></script>
		<script src="js/math.js"></script>
		<script src="js/plotly-2.6.3.min.js"></script>
		<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>
		<script src="http://city.9pr.ru/socket.io/socket.io.js"></script>

		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,

				center: false,

				slideNumber: true,

				controls: true, 

				dependencies: [
					{
						src: 'plugin/menu/menu.js'
					},
				],

				menu : {
					numbers: true,
					markers: true, 
				},

				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes, RevealMath.KaTeX]
			});
		</script>
		<script>
			window.onload = () => {

				//Рисуем круг
				let layout = {
					title: 'Тригонометрический круг',
					xaxis: {
						range: [-1.5, 1.5],
					},
					yaxis: {
						range: [-1.5, 1.5],
					},
					width: 500,
					height: 500,
					shapes: [
						{
							type: 'circle',
							xref: 'x',
							yref: 'y',
							x0: -1,
							y0: -1,
							x1: 1,
							y1: 1,
							line: {
								color: 'rgba(50, 171, 96, 1)',
							},
						},
						{
							type: 'line',
							x0: 0,
							y0: 0,
							x1: Math.sqrt(.51),
							y1: .7,
							line: {
								color: 'blue',
								width: 2.5,
							},
						},
						{
							type: 'line',
							x0: 0,
							y0: .7,
							x1: Math.sqrt(.51),
							y1: .7,
							line: {
								color: 'red',
								width: 2.5,
							},
						},
						{
							type: 'line',
							x0: Math.sqrt(.51),
							y0: 0,
							x1: Math.sqrt(.51),
							y1: .7,
							line: {
								color: 'red',
								width: 2.5,
							},
						},
					],
					annotations: [
						{
							x: 0,
							y: .7,
							xref: 'x',
							yref: 'y',
							text: 'Yb',
							arrowhead:7, 
							showarrow: true,
							ay: 0,
							ax: -20,
						},
						{
							x: Math.sqrt(.51),
							y: 0,
							xref: 'x',
							yref: 'y',
							text: 'Xb',
							arrowhead:7, 
							showarrow: true,
							ay: 20,
							ax: 0,
						},
						{
							x:  Math.sqrt(.51),
							y: .7,
							text: 'B',
						},
						{
							x: -.1,
							y: -.1,
							text: '0',
							ax: 0,
							ay: 0,
						},
					],
				};
				Plotly.newPlot('plot', [], layout);

				//Рассчет ортодромы
				document.querySelector('#ortodroma').onclick = (e) => {
					let latA = document.querySelector('#latA').value;
					let latB = document.querySelector('#latB').value;
					let lonA = document.querySelector('#lonA').value;
					let lonB = document.querySelector('#lonB').value;
					if (latA === '' || latB === '' || lonA === '' || lonB === '') {
						alert('Не все поля заполнены');
					}
					if (
						+latA < -90 || +latA > 90 ||
						+latB < -90 || +latB > 90 ||
						+lonA < -180 || +lonA > 180 ||
						+lonB < -180 || +lonB > 180
					) {
						alert('Неверное значение одного из полей');
					}
					let result = ortodroma(+latA, +lonA, +latB, +lonB);
					document.querySelector('#ortodroma_out').innerHTML = result;
				}

				// Конвертер величин
				document.querySelector('#converter_button').onclick = () => {
					let converterValue = document.querySelector('#converter_value');
					let converterType = document.querySelector('#converter_type');
					let converterOut = document.querySelector('#converter_out');
					if (converterValue.value === '') {
						alert('Поле не заполнено');
					}
					let currentType = +converterType.options.selectedIndex;
					if (currentType === 0) {
						result = katex.renderToString( 
							math.evaluate('180 * ' + converterValue.value + '/ pi') + 
							'^{\\circ}');
					} else if (currentType === 1) {
						result = katex.renderToString( math.simplify(converterValue.value + 
						' * pi / 180').toTex());
					}
					converterOut.innerHTML = result;
				}

				//Таблица тригонометрических функций
				let values = ['0', 'pi/6', 'pi/4', 'pi/3', 'pi/2', 
					'pi', '3pi/2', '2pi',	
				];
				let functions = ['sin', 'cos', 'tan'];
				trigonometry(values, functions);

				// Игра 1
				document.querySelector('#game1_start').onclick = () => {
					document.querySelector('#game1_start').style.display = 'none';
					document.querySelector('#game1_area').style.display = 'block';
					map_game1 = L.map('game1_map').setView([51.478, 0, 0], 13);
					L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png')
					.addTo(map_game1);
				}
				const game1Set = new Set();
				document.querySelector('#game1_set_result').onclick = async () => {
					let town = document.querySelector('#game1_town').value;
					if (game1Set.has(town)) {
						alert('Данный город уже был');
					} else {
						game1Set.add(town);
						let response = await fetch(`http://city.9pr.ru/city/${town}`);
						let text = await response.text();
						text = JSON.parse(text);
						console.log(text);
					}
					console.log(town);
				}
			}

			function ortodroma (latA, lonA, latB, lonB) {
				return 6372795 * Math.acos (
					Math.cos(deg2rad(latB)) * Math.cos(deg2rad(latA)) *
					Math.cos(deg2rad(lonA) - deg2rad(lonB)) + 
					Math.sin(deg2rad(latB)) * Math.sin(deg2rad(latA))
				);
			}

			function deg2rad (degree) {
				return Math.PI * degree / 180;
			}

			function trigonometry(values, functions) {
				let table = '<table><thead>';
					table += '<tr><td>Радианы</td>';
					for (let value of values) {
						table += `<td>${katex.renderToString(
							Algebrite.simplify(value).toLatexString())}</td>`;
					}
					table += '</tr><thead><tbody>';
					for (let func of functions) {
						table += `<tr><td>${func}${
							katex.renderToString('\\alpha')}</td>`;
							for (value of values) {
								table += `<td>${katex.renderToString(Algebrite.simplify(
									func+'('+value+')').toLatexString())}</td>`;
							}
					}
				table += '</tbody></table>';
				document.querySelector('#table').innerHTML = table;
			}
		</script>
	</body>
</html>
